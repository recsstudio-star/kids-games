<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ª–æ–∂–∏ —è–±–ª–æ–∫–∏</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive;
            background: #f0fff0;
            margin: 0;
            padding: 20px;
            text-align: center;
            user-select: none;
        }
        .header {
            margin-bottom: 20px;
        }
        .task {
            font-size: 24px;
            color: #d2691e;
        }
        .equation {
            font-size: 32px;
            color: #2e8b57;
            margin: 15px 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 auto;
            width: 100%;
            max-width: 500px;
        }
        .trees-row {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 20px;
        }
        .tree-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 10px;
        }
        .tree {
            width: 120px;
            height: 160px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 160"><path d="M60 10 L110 80 L90 80 L120 150 L0 150 L30 80 L10 80 Z" fill="%238b4513"/><circle cx="60" cy="40" r="35" fill="%233c8d40"/><circle cx="40" cy="65" r="30" fill="%233c8d40"/><circle cx="80" cy="60" r="25" fill="%233c8d40"/></svg>') no-repeat;
            position: relative;
            margin-bottom: 10px;
        }
        .tree-label {
            font-size: 18px;
            color: #5c6bc0;
        }
        .apple {
            width: 25px;
            height: 25px;
            position: absolute;
            cursor: grab;
            font-size: 25px;
            transition: all 0.3s;
            z-index: 10;
        }
        .apple:active {
            cursor: grabbing;
            transform: scale(1.3);
        }
        .arrows-row {
            display: flex;
            justify-content: center;
            width: 100%;
            margin: 10px 0;
        }
        .arrow {
            width: 40px;
            height: 40px;
            margin: 0 20px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><path d="M5 20 L35 20 M30 15 L35 20 L30 25" stroke="%23e67c22" stroke-width="3" fill="none"/></svg>') no-repeat center;
        }
        .basket-container {
            margin-top: 20px;
            position: relative;
        }
        .basket {
            width: 100px;
            height: 70px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 70"><path d="M5 5 L95 5 L85 60 L15 60 Z" fill="%23ffcc80" stroke="%23e67c22" stroke-width="2"/></svg>') no-repeat;
            position: relative;
        }
        .basket-highlight {
            position: absolute;
            width: 110px;
            height: 80px;
            border: 3px dashed #4CAF50;
            border-radius: 5px;
            top: -5px;
            left: -5px;
            display: none;
        }
        .counter {
            font-size: 18px;
            color: #5c6bc0;
            margin-top: 5px;
        }
        .result {
            font-size: 40px;
            color: #e91e63;
            margin: 20px 0;
            min-height: 50px;
        }
        .next-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 18px;
            border-radius: 20px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }
        .next-btn:hover {
            background: #388e3c;
        }
	.back-to-menu-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive, Arial, sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255,107,107,0.3);
            z-index: 1000;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-to-menu-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255,107,107,0.4);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="task">–°–ª–æ–∂–∏ —è–±–ª–æ–∫–∏ –∏–∑ –¥–≤—É—Ö –¥–µ—Ä–µ–≤—å–µ–≤!</div>
        <div class="equation">
            <div class="tree-container">
                <span id="num1">3</span>
            </div>
            <span style="margin: 0 10px">+</span>
            <div class="tree-container">
                <span id="num2">2</span>
            </div>
            <span style="margin: 0 10px">=</span>
            <span id="result">?</span>
        </div>
    </div>
    
    <div class="game-area">
        <div class="trees-row">
            <div class="tree-container">
                <div class="tree" id="tree1"></div>
                <div class="tree-label">–ü–µ—Ä–≤–æ–µ –¥–µ—Ä–µ–≤–æ</div>
            </div>
            
            <div class="tree-container">
                <div class="tree" id="tree2"></div>
                <div class="tree-label">–í—Ç–æ—Ä–æ–µ –¥–µ—Ä–µ–≤–æ</div>
            </div>
        </div>
        
        <div class="arrows-row">
            <div class="arrow"></div>
            <div class="arrow"></div>
        </div>
        
        <div class="basket-container">
            <div class="basket" id="basket">
                <div class="basket-highlight" id="basket-highlight"></div>
            </div>
            <div class="counter">–°–æ–±—Ä–∞–Ω–æ: <span id="total-counter">0</span></div>
        </div>
    </div>
    
    <div class="result" id="result-display"></div>
    
    <button class="next-btn" id="next-btn">–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–º–µ—Ä</button>
	<button class="back-to-menu-button" onclick="goBackToMenu()">
        üè† –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é
    </button>
    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let applesInBasket = 0;
        let totalApples = 0;
        let isDragging = false;
        let num1 = 0, num2 = 0;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const tree1 = document.getElementById('tree1');
        const tree2 = document.getElementById('tree2');
        const basket = document.getElementById('basket');
        const basketHighlight = document.getElementById('basket-highlight');
        const num1Element = document.getElementById('num1');
        const num2Element = document.getElementById('num2');
        const resultElement = document.getElementById('result');
        const resultDisplay = document.getElementById('result-display');
        const nextBtn = document.getElementById('next-btn');
        const totalCounter = document.getElementById('total-counter');

        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            generateProblem();
        }
	function goBackToMenu() {
            window.location.href = 'index.html'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞ –≤–∞—à–µ–≥–æ –º–µ–Ω—é
        }
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
        function generateProblem() {
            // –°–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞ (–æ—Ç 1 –¥–æ 5 –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
            num1 = Math.floor(Math.random() * 3) + 1;
            num2 = Math.floor(Math.random() * 3) + 1;
            totalApples = num1 + num2;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ
            num1Element.textContent = num1;
            num2Element.textContent = num2;
            resultElement.textContent = '?';
            resultDisplay.textContent = '';
            totalCounter.textContent = '0';
            
            // –û—á–∏—â–∞–µ–º –¥–µ—Ä–µ–≤—å—è –∏ –∫–æ—Ä–∑–∏–Ω—É
            tree1.innerHTML = '';
            tree2.innerHTML = '';
            basket.innerHTML = '';
            basket.appendChild(basketHighlight);
            
            // –°–æ–∑–¥–∞–µ–º —è–±–ª–æ–∫–∏ –Ω–∞ –¥–µ—Ä–µ–≤—å—è—Ö
            createApples(tree1, num1);
            createApples(tree2, num2);
            
            applesInBasket = 0;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —è–±–ª–æ–∫ –Ω–∞ –¥–µ—Ä–µ–≤–µ
        function createApples(tree, count) {
            for (let i = 0; i < count; i++) {
                const apple = document.createElement('div');
                apple.className = 'apple';
                apple.innerHTML = 'üçé';
                apple.draggable = true;
                
                // –ü–æ–∑–∏—Ü–∏—è –Ω–∞ –¥–µ—Ä–µ–≤–µ (—á—Ç–æ–±—ã —è–±–ª–æ–∫–∏ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞)
                const angle = (i / count) * Math.PI * 2;
                const radius = 30;
                const left = 60 + Math.cos(angle) * radius - 12;
                const top = 50 + Math.sin(angle) * radius - 12;
                
                apple.style.left = `${left}px`;
                apple.style.top = `${top}px`;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
                apple.dataset.originalLeft = left;
                apple.dataset.originalTop = top;
                
                // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
                apple.addEventListener('dragstart', dragStart);
                apple.addEventListener('dragend', dragEnd);
                
                tree.appendChild(apple);
            }
        }

        // –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
        function dragStart(e) {
            isDragging = true;
            e.target.style.opacity = '0.7';
            basketHighlight.style.display = 'block';
            e.dataTransfer.setData('text/plain', e.target.id);
        }

        // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–∞–¥ –∫–æ—Ä–∑–∏–Ω–æ–π
        basket.addEventListener('dragover', e => {
            e.preventDefault();
            basketHighlight.style.borderColor = '#FF5722';
        });

        // –£—Ö–æ–¥ —Å –∫–æ—Ä–∑–∏–Ω—ã
        basket.addEventListener('dragleave', () => {
            basketHighlight.style.borderColor = '#4CAF50';
        });

        // –ë—Ä–æ—Å–∞–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
        basket.addEventListener('drop', e => {
            e.preventDefault();
            basketHighlight.style.display = 'none';
            basketHighlight.style.borderColor = '#4CAF50';
            
            if (!isDragging) return;
            
            const apple = document.querySelector('.apple[style*="opacity: 0.7"]');
            if (apple) {
                // –ü–µ—Ä–µ–Ω–æ—Å–∏–º —è–±–ª–æ–∫–æ –≤ –∫–æ—Ä–∑–∏–Ω—É
                apple.style.position = 'absolute';
                apple.style.left = `${Math.random() * (basket.offsetWidth - 25)}px`;
                apple.style.top = `${Math.random() * (basket.offsetHeight - 25)}px`;
                apple.style.opacity = '1';
                apple.style.cursor = 'default';
                apple.draggable = false;
                basket.appendChild(apple);
                
                applesInBasket++;
                totalCounter.textContent = applesInBasket;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
                if (applesInBasket === totalApples) {
                    showResult();
                }
            }
            
            isDragging = false;
        });

        // –ö–æ–Ω–µ—Ü –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –≤ –∫–æ—Ä–∑–∏–Ω—É)
        function dragEnd(e) {
            if (isDragging) {
                e.target.style.opacity = '1';
                e.target.style.left = e.target.dataset.originalLeft + 'px';
                e.target.style.top = e.target.dataset.originalTop + 'px';
                basketHighlight.style.display = 'none';
                isDragging = false;
            }
        }

        // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        function showResult() {
            const answer = num1 + num2;
            
            resultElement.textContent = answer;
            resultDisplay.textContent = `–í–µ—Ä–Ω–æ! ${num1} + ${num2} = ${answer}`;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —è–±–ª–æ–∫ –≤ –∫–æ—Ä–∑–∏–Ω–µ
            const collectedApples = basket.querySelectorAll('.apple');
            collectedApples.forEach((apple, i) => {
                setTimeout(() => {
                    apple.style.transform = 'translateY(-5px)';
                    setTimeout(() => apple.style.transform = 'translateY(0)', 200);
                }, i * 150);
            });
        }

        // –ö–Ω–æ–ø–∫–∞ "–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–º–µ—Ä"
        nextBtn.addEventListener('click', generateProblem);

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        startGame();
    </script>
</body>
</html>