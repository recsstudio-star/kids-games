<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Minecraft 3D</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
            overflow: hidden;
        }
	.back-to-menu-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive, Arial, sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255,107,107,0.3);
            z-index: 1000;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-to-menu-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255,107,107,0.4);
        }
        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        .ui-panel {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            z-index: 200;
            border: 1px solid #4CAF50;
            pointer-events: auto;
            font-size: 12px;
            line-height: 1.3;
            max-width: 180px;
        }

        .health-bar {
            width: 120px;
            height: 12px;
            background: #333;
            border: 1px solid #666;
            margin: 3px 0;
            position: relative;
            border-radius: 2px;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ffaa00, #44ff44);
            transition: width 0.3s ease;
        }

        .inventory {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 3px;
            background: rgba(0, 0, 0, 0.7);
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #4CAF50;
            z-index: 200;
            pointer-events: auto;
        }

        .inventory-slot {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, rgba(68,68,68,0.8), rgba(102,102,102,0.8));
            border: 1px solid #666;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            border-radius: 4px;
            pointer-events: auto;
            font-size: 14px;
        }

        .inventory-slot.selected {
            border-color: #4CAF50;
            box-shadow: 0 0 6px rgba(76, 175, 80, 0.8);
            background: linear-gradient(135deg, rgba(76,175,80,0.3), rgba(56,142,60,0.3));
        }

        .inventory-slot .count {
            position: absolute;
            bottom: 1px;
            right: 1px;
            font-size: 8px;
            color: white;
            background: rgba(0, 0, 0, 0.9);
            padding: 1px 2px;
            border-radius: 2px;
            min-width: 10px;
            text-align: center;
        }

        .world {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: repeat(25, 1fr);
            grid-template-rows: repeat(18, 1fr);
            gap: 1px;
            z-index: 1;
        }

        .block {
            position: relative;
            cursor: pointer;
            transition: all 0.1s;
            border-radius: 2px;
            box-shadow: inset 0 0 0 1px rgba(255,255,255,0.3);
        }

        .block:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        /* –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –±–ª–æ–∫–æ–≤ */
        .block.grass { 
            background: linear-gradient(135deg, #7CB342 0%, #689F38 50%, #558B2F 100%);
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(255,255,255,0.3) 1px, transparent 1px),
                radial-gradient(circle at 80% 60%, rgba(255,255,255,0.2) 1px, transparent 1px);
        }
        .block.dirt { 
            background: linear-gradient(135deg, #8D6E63 0%, #795548 50%, #5D4037 100%);
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(0,0,0,0.1) 2px, rgba(0,0,0,0.1) 4px);
        }
        .block.stone { 
            background: linear-gradient(135deg, #9E9E9E 0%, #757575 50%, #616161 100%);
            background-image: 
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4) 2px, transparent 2px),
                radial-gradient(circle at 70% 70%, rgba(0,0,0,0.3) 1px, transparent 1px);
        }
        .block.wood { 
            background: linear-gradient(90deg, #8BC34A 0%, #7CB342 20%, #689F38 40%, #7CB342 60%, #8BC34A 80%, #9CCC65 100%);
            background-size: 20px 100%;
        }
        .block.leaves { 
            background: linear-gradient(135deg, #4CAF50 0%, #388E3C 50%, #2E7D32 100%);
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.3) 1px, transparent 1px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.2) 1px, transparent 1px),
                radial-gradient(circle at 50% 10%, rgba(0,0,0,0.2) 1px, transparent 1px);
        }
        .block.coal { 
            background: linear-gradient(135deg, #424242 0%, #212121 50%, #000000 100%);
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 1px, transparent 1px);
        }
        .block.iron { 
            background: linear-gradient(135deg, #CFD8DC 0%, #B0BEC5 50%, #90A4AE 100%);
            background-image: 
                linear-gradient(45deg, rgba(255,255,255,0.5) 25%, transparent 25%),
                linear-gradient(-45deg, rgba(255,255,255,0.5) 25%, transparent 25%);
            background-size: 4px 4px;
        }
        .block.gold { 
            background: linear-gradient(135deg, #FFD700 0%, #FFC107 50%, #FF8F00 100%);
            background-image: 
                radial-gradient(circle at 30% 20%, rgba(255,255,255,0.6) 2px, transparent 2px),
                radial-gradient(circle at 70% 80%, rgba(255,255,255,0.4) 1px, transparent 1px);
        }
        .block.diamond { 
            background: linear-gradient(135deg, #00BCD4 0%, #0097A7 50%, #006064 100%);
            background-image: 
                linear-gradient(30deg, rgba(255,255,255,0.8) 50%, transparent 50%),
                linear-gradient(-30deg, rgba(255,255,255,0.6) 50%, transparent 50%);
            animation: diamond-sparkle 2s infinite;
        }

        .block.goal { 
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 50%, #FF6B6B 100%);
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(255,255,255,0.8) 3px, transparent 3px),
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.4) 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.4) 2px, transparent 2px);
            animation: goal-pulse 1.5s infinite;
            border: 3px solid #FF4757 !important;
            box-shadow: 0 0 20px rgba(255, 71, 87, 0.6);
        }

        @keyframes goal-pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 71, 87, 0.6);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 0 30px rgba(255, 71, 87, 0.8);
            }
        }

        .player {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            border-radius: 5px;
            z-index: 50;
            transition: all 0.3s ease;
            border: 2px solid #0D47A1;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .player::before {
            content: 'üë§';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 16px;
        }

        .monster {
            position: absolute;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #f44336 0%, #c62828 100%);
            border-radius: 5px;
            z-index: 50;
            transition: all 0.5s ease;
            border: 2px solid #b71c1c;
            box-shadow: 0 2px 15px rgba(244, 67, 54, 0.5);
            animation: monster-pulse 1s infinite alternate;
        }

        .monster::before {
            content: 'üëπ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
        }

        @keyframes monster-pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }

        .math-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .math-modal.show {
            display: flex;
        }

        .math-content {
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            animation: modalPop 0.3s ease;
            border: 3px solid #0D47A1;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        @keyframes modalPop {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .math-question {
            font-size: 28px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .math-input {
            font-size: 20px;
            padding: 15px;
            border: none;
            border-radius: 10px;
            margin: 10px;
            width: 120px;
            text-align: center;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }

        .math-buttons {
            margin-top: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.4);
        }

        .btn.cancel {
            background: linear-gradient(135deg, #f44336 0%, #c62828 100%);
        }

        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            z-index: 2000;
            display: none;
            border: 2px solid #4CAF50;
            animation: notification-pop 0.5s ease;
        }

        @keyframes notification-pop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .mode-selector {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 10px;
            border-radius: 8px;
            border: 1px solid #4CAF50;
            z-index: 200;
            pointer-events: auto;
            font-size: 11px;
        }

        .mode-btn {
            background: linear-gradient(135deg, rgba(102,102,102,0.8) 0%, rgba(68,68,68,0.8) 100%);
            color: white;
            border: none;
            padding: 4px 8px;
            margin: 1px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            pointer-events: auto;
            font-size: 10px;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, rgba(76,175,80,0.9) 0%, rgba(56,142,60,0.9) 100%);
            box-shadow: 0 1px 4px rgba(76, 175, 80, 0.4);
        }

        .danger-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 0, 0, 0.1);
            pointer-events: none;
            z-index: 5;
            animation: danger-flash 0.5s infinite alternate;
            display: none;
        }

        .danger-overlay.show {
            display: block;
        }

        @keyframes danger-flash {
            0% { opacity: 0.1; }
            100% { opacity: 0.3; }
        }

        .block-damage {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 2px,
                rgba(255, 0, 0, 0.3) 2px,
                rgba(255, 0, 0, 0.3) 4px
            );
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .controls-help {
            position: absolute;
            bottom: 50px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 10px;
            max-width: 150px;
            z-index: 200;
            pointer-events: auto;
            line-height: 1.2;
        }

        /* –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –∫–Ω–æ–ø–∫–∞ */
        .new-game-btn {
            position: absolute;
            top: 5px;
            right: 120px;
            background: linear-gradient(135deg, rgba(255,152,0,0.9) 0%, rgba(245,124,0,0.9) 100%);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            transition: all 0.2s ease;
            box-shadow: 0 2px 6px rgba(255, 152, 0, 0.3);
            z-index: 200;
            pointer-events: auto;
        }

        .new-game-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(255, 152, 0, 0.5);
        }

        /* –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã */
        .game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            color: white;
            text-align: center;
        }

        .game-over-screen.show {
            display: flex;
        }

        .game-over-content {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            border: 3px solid #8b0000;
            box-shadow: 0 15px 40px rgba(0,0,0,0.8);
            animation: gameOverPop 0.5s ease;
            max-width: 500px;
            width: 90%;
        }

        @keyframes gameOverPop {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .game-over-title {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            color: #ffebee;
            animation: titleShake 0.5s ease-in-out;
        }

        @keyframes titleShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .game-over-stats {
            font-size: 18px;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
        }

        .game-over-buttons {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .game-over-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }

        .game-over-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.5);
        }

        .game-over-btn.secondary {
            background: linear-gradient(135deg, #666 0%, #444 100%);
            box-shadow: 0 6px 20px rgba(102, 102, 102, 0.3);
        }

        .game-over-btn.secondary:hover {
            box-shadow: 0 8px 25px rgba(102, 102, 102, 0.5);
        }

        /* –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã —É—Ä–æ–≤–Ω—è */
        .level-complete-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            color: white;
            text-align: center;
        }

        .level-complete-screen.show {
            display: flex;
        }

        .level-complete-content {
            background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            border: 3px solid #2E7D32;
            box-shadow: 0 15px 40px rgba(0,0,0,0.8);
            animation: levelCompletePop 0.5s ease;
            max-width: 500px;
            width: 90%;
        }

        @keyframes levelCompletePop {
            0% { transform: scale(0.5) rotate(-5deg); opacity: 0; }
            50% { transform: scale(1.1) rotate(0deg); opacity: 0.8; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .level-complete-title {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            animation: titleGlow 1s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            0% { text-shadow: 3px 3px 6px rgba(0,0,0,0.8); }
            100% { text-shadow: 3px 3px 20px rgba(255,255,255,0.8); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="ui-panel">
            <div>–û—á–∫–∏: <span id="score">0</span></div>
            <div>–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span></div>
            <div>–ó–¥–æ—Ä–æ–≤—å–µ:</div>
            <div class="health-bar">
                <div class="health-fill" id="healthFill" style="width: 100%"></div>
            </div>
            <div>–†–µ–∂–∏–º: <span id="current-mode">–ö–æ–ø–∞–Ω–∏–µ</span></div>
            <div>–ú–æ–Ω—Å—Ç—Ä —á–µ—Ä–µ–∑: <span id="monster-distance">-</span></div>
            <div style="color: #FF6B6B; font-weight: bold;">üéØ –¶–µ–ª—å: <span id="goal-distance">-</span></div>
        </div>

        <button class="new-game-btn" onclick="restartGame()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>

        <div class="mode-selector">
            <div>–†–µ–∂–∏–º –∏–≥—Ä—ã:</div>
            <button class="mode-btn active" onclick="setMode('mine')">–ö–æ–ø–∞–Ω–∏–µ</button>
            <button class="mode-btn" onclick="setMode('build')">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ</button>
        </div>
	<button class="back-to-menu-button" onclick="goBackToMenu()">
        üè† –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é
    	</button>
        <div class="controls-help">
            <strong>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong><br>
            WASD - –¥–≤–∏–∂–µ–Ω–∏–µ<br>
            –ö–ª–∏–∫ - –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ<br>
            üéØ –î–æ–π–¥–∏—Ç–µ –¥–æ —Ü–µ–ª–∏!<br>
            –£–±–µ–≥–∞–π—Ç–µ –æ—Ç –º–æ–Ω—Å—Ç—Ä–∞! üëπ
        </div>

        <div class="world" id="world"></div>
        <div class="player" id="player"></div>
        <div class="monster" id="monster"></div>

        <div class="inventory">
            <div class="inventory-slot selected" data-block="grass">üå±<span class="count">0</span></div>
            <div class="inventory-slot" data-block="dirt">üü´<span class="count">0</span></div>
            <div class="inventory-slot" data-block="stone">‚¨ú<span class="count">0</span></div>
            <div class="inventory-slot" data-block="wood">ü™µ<span class="count">0</span></div>
            <div class="inventory-slot" data-block="coal">‚ö´<span class="count">0</span></div>
            <div class="inventory-slot" data-block="iron">üî©<span class="count">0</span></div>
            <div class="inventory-slot" data-block="gold">üü®<span class="count">0</span></div>
            <div class="inventory-slot" data-block="diamond">üíé<span class="count">0</span></div>
        </div>

        <div class="danger-overlay" id="dangerOverlay"></div>
    </div>

    <div class="math-modal" id="mathModal">
        <div class="math-content">
            <div class="math-question" id="mathQuestion"></div>
            <input type="number" class="math-input" id="mathAnswer" placeholder="?">
            <div class="math-buttons">
                <button class="btn" onclick="checkAnswer()">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
                <button class="btn cancel" onclick="closeMathModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
            <div style="margin-top: 10px; font-size: 14px; opacity: 0.8;">
                –¢–æ–ª—å–∫–æ —Å–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ! üßÆ
            </div>
        </div>
    </div>

    <div class="game-over-screen" id="gameOverScreen">
        <div class="game-over-content">
            <div class="game-over-title">–í–´ –ü–†–û–ò–ì–†–ê–õ–ò! üíÄ</div>
            <div style="font-size: 20px; margin-bottom: 20px;">–ú–æ–Ω—Å—Ç—Ä –≤–∞—Å –ø–æ–π–º–∞–ª!</div>
            
            <div class="game-over-stats">
                <div><strong>–ò—Ç–æ–≥–æ–≤—ã–π —Å—á–µ—Ç:</strong> <span id="finalScore">0</span></div>
                <div><strong>–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å:</strong> <span id="finalLevel">1</span></div>
                <div><strong>–ë–ª–æ–∫–æ–≤ –¥–æ–±—ã—Ç–æ:</strong> <span id="blocksMinedTotal">0</span></div>
            </div>
            
            <div class="game-over-buttons">
                <button class="game-over-btn" onclick="restartGameFromOver()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button class="game-over-btn secondary" onclick="hideGameOver()">üìä –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
            </div>
        </div>
    </div>

    <!-- –ù–æ–≤—ã–π —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è -->
    <div class="level-complete-screen" id="levelCompleteScreen">
        <div class="level-complete-content">
            <div class="level-complete-title">üéâ –£–†–û–í–ï–ù–¨ –ü–†–û–ô–î–ï–ù! üéâ</div>
            <div style="font-size: 20px; margin-bottom: 20px;">–¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!</div>
            
            <div class="game-over-stats">
                <div><strong>–ü–æ–ª—É—á–µ–Ω–æ –æ—á–∫–æ–≤:</strong> <span id="levelBonus">0</span></div>
                <div><strong>–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å:</strong> <span id="newLevel">2</span></div>
                <div><strong>–í—Å–µ–≥–æ –æ—á–∫–æ–≤:</strong> <span id="totalScore">0</span></div>
            </div>
            
            <div class="game-over-buttons">
                <button class="game-over-btn" onclick="startNextLevel()">‚û°Ô∏è –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</button>
                <button class="game-over-btn secondary" onclick="restartGame()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameMode = 'mine';
        let selectedBlock = 'grass';
        let score = 0;
        let level = 1;
        let health = 100;
        let currentMathProblem = null;
        let currentAction = null;
        let currentPosition = null;
        let gameRunning = true;
        let blocksMinedCount = 0;
        let goalPos = { x: 15, y: 8 };
        let goalReached = false;
        let levelTransition = false; // –§–ª–∞–≥ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–Ω—Å—Ç—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ —É—Ä–æ–≤–Ω—è

        // –ü–æ–∑–∏—Ü–∏–∏
        let playerPos = { x: 5, y: 5 };
        let monsterPos = { x: 20, y: 15 };
        let monsterTarget = null;
        let monsterMoveInterval = null;

        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞
        let inventory = {
            grass: 0, dirt: 0, stone: 0, wood: 0,
            coal: 0, iron: 0, gold: 0, diamond: 0
        };

        // –ü—Ä–æ—á–Ω–æ—Å—Ç—å –±–ª–æ–∫–æ–≤ (—Å–∫–æ–ª—å–∫–æ —Ö–æ–¥–æ–≤ –º–æ–Ω—Å—Ç—Ä—É –Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è)
        const blockStrength = {
            grass: 1, dirt: 2, stone: 4, wood: 3,
            coal: 5, iron: 8, gold: 6, diamond: 12
        };

        // –°–ª–æ–∂–Ω–æ—Å—Ç—å –±–ª–æ–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—á–∫–æ–≤, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —É–ø—Ä–æ—â–µ–Ω–∞)
        const blockDifficulty = {
            grass: 1, dirt: 1, stone: 2, wood: 2,
            coal: 3, iron: 4, gold: 5, diamond: 6
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–æ–≤ (–¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –æ—Ç –º–æ–Ω—Å—Ç—Ä–∞)
        let blockStates = {};

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            generateWorld();
            setGoal();
            positionPlayer();
            positionMonster();
            updateUI();
            setupEventListeners();
            startMonsterAI();
        }
	function goBackToMenu() {
            window.location.href = 'index.html'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞ –≤–∞—à–µ–≥–æ –º–µ–Ω—é
        }
        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å
        function setGoal() {
            // –°–Ω–∞—á–∞–ª–∞ —É–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—É—é —Ü–µ–ª—å –µ—Å–ª–∏ –µ—Å—Ç—å
            const oldGoalBlock = document.querySelector('.goal');
            if (oldGoalBlock) {
                oldGoalBlock.classList.remove('goal');
                oldGoalBlock.innerHTML = '';
                const blockIndex = parseInt(oldGoalBlock.dataset.index);
                const originalType = blockStates[blockIndex].type;
                setBlockType(oldGoalBlock, originalType);
            }
            
            // –¶–µ–ª—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–∞–ª—å—à–µ —Å –∫–∞–∂–¥—ã–º —É—Ä–æ–≤–Ω–µ–º (+2 –∫–∞–∂–¥—ã–π —Ä–∞–∑)
            const baseDistance = 8;
            const distance = baseDistance + (level - 1) * 2; // 8, 10, 12, 14...
            
            goalPos.x = Math.min(24, playerPos.x + distance);
            goalPos.y = Math.max(0, Math.min(17, playerPos.y + Math.floor(Math.random() * 6) - 3));
            
            const goalIndex = goalPos.y * 25 + goalPos.x;
            const goalBlock = document.querySelector(`[data-index="${goalIndex}"]`);
            if (goalBlock) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–∏–ø –±–ª–æ–∫–∞
                blockStates[goalIndex].originalType = blockStates[goalIndex].type;
                
                goalBlock.classList.add('goal');
                goalBlock.innerHTML = 'üéØ';
            }
            
            goalReached = false;
            levelTransition = false;
        }

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–∏
        function checkGoal() {
            if (playerPos.x === goalPos.x && playerPos.y === goalPos.y && !goalReached && !levelTransition) {
                goalReached = true;
                levelTransition = true;
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ–Ω—Å—Ç—Ä–∞
                if (monsterMoveInterval) {
                    clearInterval(monsterMoveInterval);
                }
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–æ–Ω—É—Å
                const levelBonus = 100 * level;
                score += levelBonus;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å
                level++;
                
                // –ë–æ–Ω—É—Å –∑–¥–æ—Ä–æ–≤—å—è
                health = Math.min(100, health + 20);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
                document.getElementById('levelBonus').textContent = levelBonus;
                document.getElementById('newLevel').textContent = level;
                document.getElementById('totalScore').textContent = score;
                document.getElementById('levelCompleteScreen').classList.add('show');
                
                updateUI();
            }
        }

        // –ù–∞—á–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
        function startNextLevel() {
            document.getElementById('levelCompleteScreen').classList.remove('show');
            
            // –£–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—É—é —Ü–µ–ª—å –ü–û–õ–ù–û–°–¢–¨–Æ
            const oldGoalBlock = document.querySelector('.goal');
            if (oldGoalBlock) {
                oldGoalBlock.classList.remove('goal');
                oldGoalBlock.innerHTML = '';
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–∏–ø –±–ª–æ–∫–∞
                const blockIndex = parseInt(oldGoalBlock.dataset.index);
                const originalType = blockStates[blockIndex].type;
                setBlockType(oldGoalBlock, originalType);
            }
            
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –ª–µ–≤—É—é —á–∞—Å—Ç—å
            playerPos = { x: Math.floor(Math.random() * 3) + 1, y: Math.floor(Math.random() * 8) + 5 };
            
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –º–æ–Ω—Å—Ç—Ä–∞ –≤ –ø—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª (–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–∞–ª–µ–∫–æ!)
            monsterPos = { 
                x: Math.floor(Math.random() * 3) + 22, // x: 22-24 (–ø—Ä–∞–≤—ã–π –∫—Ä–∞–π)
                y: Math.floor(Math.random() * 3) + 15  // y: 15-17 (–Ω–∏–∂–Ω—è—è —á–∞—Å—Ç—å)
            };
            
            // –°—Ç–∞–≤–∏–º –Ω–æ–≤—É—é —Ü–µ–ª—å
            setGoal();
            positionPlayer();
            positionMonster();
            
            // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–±–æ—Ç—É –º–æ–Ω—Å—Ç—Ä–∞
            levelTransition = false;
            startMonsterAI();
            
            updateUI();
            showNotification(`üéâ –£—Ä–æ–≤–µ–Ω—å ${level}! –¶–µ–ª—å —Ç–µ–ø–µ—Ä—å –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ ${8 + (level-1)*2} –±–ª–æ–∫–æ–≤!`);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏
        function updateGoalDistance() {
            const distance = Math.abs(playerPos.x - goalPos.x) + Math.abs(playerPos.y - goalPos.y);
            document.getElementById('goal-distance').textContent = distance + ' –±–ª–æ–∫–æ–≤';
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏—Ä–∞
        function generateWorld() {
            const world = document.getElementById('world');
            world.innerHTML = '';

            for (let i = 0; i < 450; i++) { // 25x18
                const block = document.createElement('div');
                block.className = 'block';
                block.dataset.index = i;
                
                const row = Math.floor(i / 25);
                const col = i % 25;
                const blockType = getRandomBlockType(row, col);
                setBlockType(block, blockType);
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–∞
                blockStates[i] = {
                    type: blockType,
                    damage: 0,
                    maxHealth: blockStrength[blockType] || 1
                };
                
                block.addEventListener('click', () => handleBlockClick(i, blockType));
                world.appendChild(block);
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —Ç–∏–ø –±–ª–æ–∫–∞ —Å —É—á–µ—Ç–æ–º –ø–æ–∑–∏—Ü–∏–∏
        function getRandomBlockType(row, col) {
            const rand = Math.random();
            
            // –í–µ—Ä—Ö–Ω–∏–µ —Å–ª–æ–∏ - –±–æ–ª—å—à–µ —Ç—Ä–∞–≤—ã –∏ –¥–µ—Ä–µ–≤–∞
            if (row < 3) {
                if (rand < 0.8) return 'grass';
                if (rand < 0.95) return 'wood';
                return 'leaves';
            }
            
            // –°—Ä–µ–¥–Ω–∏–µ —Å–ª–æ–∏ - –∑–µ–º–ª—è, –∫–∞–º–µ–Ω—å, –Ω–µ–º–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤
            if (row < 8) {
                if (rand < 0.4) return 'dirt';
                if (rand < 0.7) return 'stone';
                if (rand < 0.85) return 'wood';
                if (rand < 0.95) return 'coal';
                return 'iron';
            }
            
            // –ù–∏–∂–Ω–∏–µ —Å–ª–æ–∏ - –±–æ–ª—å—à–µ —Ü–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
            if (row < 15) {
                if (rand < 0.2) return 'dirt';
                if (rand < 0.4) return 'stone';
                if (rand < 0.6) return 'coal';
                if (rand < 0.8) return 'iron';
                if (rand < 0.95) return 'gold';
                return 'diamond';
            }
            
            // –°–∞–º—ã–µ –≥–ª—É–±–æ–∫–∏–µ —Å–ª–æ–∏
            if (rand < 0.1) return 'stone';
            if (rand < 0.3) return 'coal';
            if (rand < 0.6) return 'iron';
            if (rand < 0.85) return 'gold';
            return 'diamond';
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∏–ø –±–ª–æ–∫–∞
        function setBlockType(block, type) {
            block.className = `block ${type}`;
            block.dataset.blockType = type;
        }

        // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–∫–∞
        function positionPlayer() {
            const player = document.getElementById('player');
            const cellWidth = window.innerWidth / 25;
            const cellHeight = window.innerHeight / 18;
            
            player.style.left = (playerPos.x * cellWidth + cellWidth/2 - 15) + 'px';
            player.style.top = (playerPos.y * cellHeight + cellHeight/2 - 15) + 'px';
        }

        // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω—Å—Ç—Ä–∞
        function positionMonster() {
            const monster = document.getElementById('monster');
            const cellWidth = window.innerWidth / 25;
            const cellHeight = window.innerHeight / 18;
            
            monster.style.left = (monsterPos.x * cellWidth + cellWidth/2 - 17) + 'px';
            monster.style.top = (monsterPos.y * cellHeight + cellHeight/2 - 17) + 'px';
        }

        // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∏–≥—Ä–æ–∫–∞
        function movePlayer(dx, dy) {
            if (!gameRunning || levelTransition) return;
            
            const newX = Math.max(0, Math.min(24, playerPos.x + dx));
            const newY = Math.max(0, Math.min(17, playerPos.y + dy));
            
            const blockIndex = newY * 25 + newX;
            const blockType = blockStates[blockIndex].type;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –±–ª–æ–∫
            if (blockType === 'grass' || blockStates[blockIndex].damage >= blockStates[blockIndex].maxHealth) {
                playerPos.x = newX;
                playerPos.y = newY;
                positionPlayer();
                
                checkPlayerMonsterCollision();
                checkGoal(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–∏
            }
        }

        // –ò–ò –º–æ–Ω—Å—Ç—Ä–∞
        function startMonsterAI() {
            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
            if (monsterMoveInterval) {
                clearInterval(monsterMoveInterval);
            }
            
            monsterMoveInterval = setInterval(() => {
                if (!gameRunning || levelTransition) return;
                
                moveMonsterTowardsPlayer();
                checkPlayerMonsterCollision();
                updateMonsterDistance();
            }, 1500 - level * 100); // –ú–æ–Ω—Å—Ç—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ —Å —É—Ä–æ–≤–Ω–µ–º
        }

        // –î–≤–∏–≥–∞—Ç—å –º–æ–Ω—Å—Ç—Ä–∞ –∫ –∏–≥—Ä–æ–∫—É
        function moveMonsterTowardsPlayer() {
            if (levelTransition) return; // –ù–µ –¥–≤–∏–≥–∞–µ–º –º–æ–Ω—Å—Ç—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ —É—Ä–æ–≤–Ω—è
            
            const dx = playerPos.x - monsterPos.x;
            const dy = playerPos.y - monsterPos.y;
            
            let moveX = 0, moveY = 0;
            
            if (Math.abs(dx) > Math.abs(dy)) {
                moveX = dx > 0 ? 1 : -1;
            } else {
                moveY = dy > 0 ? 1 : -1;
            }
            
            const newX = monsterPos.x + moveX;
            const newY = monsterPos.y + moveY;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã
            if (newX < 0 || newX > 24 || newY < 0 || newY > 17) return;
            
            const blockIndex = newY * 25 + newX;
            const blockState = blockStates[blockIndex];
            
            if (blockState.type === 'grass' || blockState.damage >= blockState.maxHealth) {
                // –ú–æ–Ω—Å—Ç—Ä –º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏
                monsterPos.x = newX;
                monsterPos.y = newY;
                positionMonster();
            } else {
                // –ú–æ–Ω—Å—Ç—Ä –ª–æ–º–∞–µ—Ç –±–ª–æ–∫
                damageBlock(blockIndex);
            }
        }

        // –ü–æ–≤—Ä–µ–¥–∏—Ç—å –±–ª–æ–∫
        function damageBlock(blockIndex) {
            const blockState = blockStates[blockIndex];
            blockState.damage++;
            
            const block = document.querySelector(`[data-index="${blockIndex}"]`);
            const damageOverlay = block.querySelector('.block-damage') || createDamageOverlay(block);
            
            const damagePercent = blockState.damage / blockState.maxHealth;
            damageOverlay.style.opacity = damagePercent;
            
            if (blockState.damage >= blockState.maxHealth) {
                // –ë–ª–æ–∫ —Ä–∞–∑—Ä—É—à–µ–Ω
                blockState.type = 'grass';
                blockState.damage = 0;
                blockState.maxHealth = 1;
                setBlockType(block, 'grass');
                damageOverlay.style.opacity = 0;
                
                showNotification(`–ú–æ–Ω—Å—Ç—Ä —Ä–∞–∑—Ä—É—à–∏–ª –±–ª–æ–∫!`);
            }
        }

        // –°–æ–∑–¥–∞—Ç—å overlay –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π
        function createDamageOverlay(block) {
            const overlay = document.createElement('div');
            overlay.className = 'block-damage';
            block.appendChild(overlay);
            return overlay;
        }

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –∏ –º–æ–Ω—Å—Ç—Ä–∞
        function checkPlayerMonsterCollision() {
            const distance = Math.abs(playerPos.x - monsterPos.x) + Math.abs(playerPos.y - monsterPos.y);
            
            if (distance <= 1 && !levelTransition) {
                gameOver();
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–ø–∞—Å–Ω–æ—Å—Ç—å –µ—Å–ª–∏ –º–æ–Ω—Å—Ç—Ä –±–ª–∏–∑–∫–æ
            const dangerOverlay = document.getElementById('dangerOverlay');
            if (distance <= 3 && !levelTransition) {
                dangerOverlay.classList.add('show');
            } else {
                dangerOverlay.classList.remove('show');
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–Ω
        function takeDamage(damage) {
            health = Math.max(0, health - damage);
            updateHealthBar();
            
            showNotification(`-${damage} –∑–¥–æ—Ä–æ–≤—å—è!`);
            
            if (health <= 0) {
                gameOver();
            }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª–æ—Å—É –∑–¥–æ—Ä–æ–≤—å—è
        function updateHealthBar() {
            const healthFill = document.getElementById('healthFill');
            healthFill.style.width = health + '%';
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –º–æ–Ω—Å—Ç—Ä–∞
        function updateMonsterDistance() {
            const distance = Math.abs(playerPos.x - monsterPos.x) + Math.abs(playerPos.y - monsterPos.y);
            document.getElementById('monster-distance').textContent = distance + ' –±–ª–æ–∫–æ–≤';
        }

        // –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞
        function gameOver() {
            gameRunning = false;
            levelTransition = false;
            clearInterval(monsterMoveInterval);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalLevel').textContent = level;
            document.getElementById('blocksMinedTotal').textContent = blocksMinedCount;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('gameOverScreen').classList.add('show');
        }

        // –°–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω –ø–æ—Ä–∞–∂–µ–Ω–∏—è
        function hideGameOver() {
            document.getElementById('gameOverScreen').classList.remove('show');
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –∏–∑ —ç–∫—Ä–∞–Ω–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
        function restartGameFromOver() {
            hideGameOver();
            restartGame();
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É
        function restartGame() {
            health = 100;
            score = 0;
            level = 1;
            blocksMinedCount = 0;
            playerPos = { x: 2, y: 8 };
            
            // –ú–æ–Ω—Å—Ç—Ä –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É
            monsterPos = { x: 23, y: 16 };
            
            gameRunning = true;
            goalReached = false;
            levelTransition = false;
            
            inventory = {
                grass: 0, dirt: 0, stone: 0, wood: 0,
                coal: 0, iron: 0, gold: 0, diamond: 0
            };
            
            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—Å–ª–∏ –µ—Å—Ç—å
            if (monsterMoveInterval) {
                clearInterval(monsterMoveInterval);
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            hideGameOver();
            document.getElementById('levelCompleteScreen').classList.remove('show');
            
            initGame();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –±–ª–æ–∫—É
        function handleBlockClick(index, blockType) {
            if (!gameRunning || levelTransition) return;
            
            const row = Math.floor(index / 25);
            const col = index % 25;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –±–ª–∏–∑–∫–æ –∏–≥—Ä–æ–∫ –∫ –±–ª–æ–∫—É
            const distance = Math.abs(playerPos.x - col) + Math.abs(playerPos.y - row);
            if (distance > 2) {
                showNotification('–°–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ! –ü–æ–¥–æ–π–¥–∏—Ç–µ –±–ª–∏–∂–µ.');
                return;
            }
            
            currentPosition = index;
            
            if (gameMode === 'mine') {
                const blockState = blockStates[index];
                if (blockState.type !== 'grass' && blockState.damage < blockState.maxHealth) {
                    currentAction = 'mine';
                    showMathModal(blockState.type);
                }
            } else if (gameMode === 'build') {
                const blockState = blockStates[index];
                if ((blockState.type === 'grass' || blockState.damage >= blockState.maxHealth) && inventory[selectedBlock] > 0) {
                    // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ - –±–µ–∑ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏!
                    buildBlock(index, selectedBlock);
                    updateUI();
                    showNotification(`–ü–æ—Å—Ç—Ä–æ–µ–Ω: ${getBlockName(selectedBlock)}`);
                }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–º–µ—Ä–æ–º
        function showMathModal(blockType) {
            // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - —Ç–æ–ª—å–∫–æ —Å–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ
            currentMathProblem = generateSimpleMathProblem();
            
            document.getElementById('mathQuestion').textContent = currentMathProblem.question;
            document.getElementById('mathAnswer').value = '';
            document.getElementById('mathModal').classList.add('show');
            document.getElementById('mathAnswer').focus();
        }

        // –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã (—Ç–æ–ª—å–∫–æ + –∏ -)
        function generateSimpleMathProblem() {
            let a, b, operation, answer, question;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω—è, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º—É–º
            const complexity = Math.min(level, 5);
            
            if (complexity <= 2) {
                // –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã: —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 20
                a = Math.floor(Math.random() * 20) + 1;
                b = Math.floor(Math.random() * 20) + 1;
            } else if (complexity <= 4) {
                // –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–∏–º–µ—Ä—ã: —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 50
                a = Math.floor(Math.random() * 50) + 1;
                b = Math.floor(Math.random() * 30) + 1;
            } else {
                // –°–ª–æ–∂–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã: —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 100
                a = Math.floor(Math.random() * 100) + 1;
                b = Math.floor(Math.random() * 50) + 1;
            }
            
            operation = Math.random() < 0.6 ? '+' : '-'; // –ë–æ–ª—å—à–µ —Å–ª–æ–∂–µ–Ω–∏–π
            
            if (operation === '+') {
                answer = a + b;
                question = `${a} + ${b} = ?`;
            } else {
                // –ü—Ä–∏ –≤—ã—á–∏—Ç–∞–Ω–∏–∏ —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
                if (a < b) [a, b] = [b, a];
                answer = a - b;
                question = `${a} - ${b} = ?`;
            }
            
            return { question, answer };
        }

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç
        function checkAnswer() {
            const answerInput = document.getElementById('mathAnswer');
            const userAnswerStr = answerInput.value.trim();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤–≤–µ–¥–µ–Ω–æ —á–∏—Å–ª–æ
            if (userAnswerStr === '' || isNaN(userAnswerStr)) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!');
                answerInput.focus();
                return;
            }
            
            const userAnswer = parseInt(userAnswerStr);
            
            if (userAnswer === currentMathProblem.answer) {
                const blockState = blockStates[currentPosition];
                const blockType = currentAction === 'mine' ? blockState.type : selectedBlock;
                
                if (currentAction === 'mine') {
                    mineBlock(currentPosition);
                    blocksMinedCount++; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –¥–æ–±—ã—Ç—ã—Ö –±–ª–æ–∫–æ–≤
                } else if (currentAction === 'build') {
                    buildBlock(currentPosition, selectedBlock);
                }
                
                const pointsEarned = blockDifficulty[blockType] * 10;
                score += pointsEarned;
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–º–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                health = Math.min(100, health + 2);
                updateHealthBar();
                
                showNotification(`–ü—Ä–∞–≤–∏–ª—å–Ω–æ! +${pointsEarned} –æ—á–∫–æ–≤`);
            } else {
                showNotification(`–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–≤–µ—Ç: ${currentMathProblem.answer}`);
                // –¢–µ—Ä—è–µ–º –∑–¥–æ—Ä–æ–≤—å–µ –∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                takeDamage(5);
            }
            
            closeMathModal();
            updateUI();
        }

        // –ö–æ–ø–∞—Ç—å –±–ª–æ–∫
        function mineBlock(index) {
            const blockState = blockStates[index];
            const blockType = blockState.type;
            
            inventory[blockType]++;
            
            // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –±–ª–æ–∫ –≤ —Ç—Ä–∞–≤—É
            blockState.type = 'grass';
            blockState.damage = 0;
            blockState.maxHealth = 1;
            
            const block = document.querySelector(`[data-index="${index}"]`);
            setBlockType(block, 'grass');
            
            // –£–±–∏—Ä–∞–µ–º overlay –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –µ—Å–ª–∏ –µ—Å—Ç—å
            const damageOverlay = block.querySelector('.block-damage');
            if (damageOverlay) {
                damageOverlay.style.opacity = 0;
            }
            
            showNotification(`–î–æ–±—ã—Ç: ${getBlockName(blockType)}`);
        }

        // –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –±–ª–æ–∫
        function buildBlock(index, blockType) {
            const blockState = blockStates[index];
            
            inventory[blockType]--;
            
            blockState.type = blockType;
            blockState.damage = 0;
            blockState.maxHealth = blockStrength[blockType];
            
            const block = document.querySelector(`[data-index="${index}"]`);
            setBlockType(block, blockType);
            
            showNotification(`–ü–æ—Å—Ç—Ä–æ–µ–Ω: ${getBlockName(blockType)}`);
        }

        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞
        function getBlockName(blockType) {
            const names = {
                grass: '–¢—Ä–∞–≤–∞', dirt: '–ó–µ–º–ª—è', stone: '–ö–∞–º–µ–Ω—å', 
                wood: '–î–µ—Ä–µ–≤–æ', coal: '–£–≥–æ–ª—å', iron: '–ñ–µ–ª–µ–∑–æ', 
                gold: '–ó–æ–ª–æ—Ç–æ', diamond: '–ê–ª–º–∞–∑', leaves: '–õ–∏—Å—Ç–≤–∞'
            };
            return names[blockType] || blockType;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(text) {
            const notification = document.getElementById('notification');
            notification.textContent = text;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2500);
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function closeMathModal() {
            document.getElementById('mathModal').classList.remove('show');
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∂–∏–º –∏–≥—Ä—ã
        function setMode(mode) {
            gameMode = mode;
            document.getElementById('current-mode').textContent = 
                mode === 'mine' ? '–ö–æ–ø–∞–Ω–∏–µ' : '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ';
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Ä–µ–∂–∏–º–æ–≤
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            Object.keys(inventory).forEach(blockType => {
                const slot = document.querySelector(`[data-block="${blockType}"]`);
                if (slot) {
                    slot.querySelector('.count').textContent = inventory[blockType];
                }
            });
            
            updateMonsterDistance();
            updateGoalDistance();
        }

        // –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –í—ã–±–æ—Ä –±–ª–æ–∫–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            document.querySelectorAll('.inventory-slot').forEach(slot => {
                slot.addEventListener('click', () => {
                    document.querySelectorAll('.inventory-slot').forEach(s => 
                        s.classList.remove('selected'));
                    slot.classList.add('selected');
                    selectedBlock = slot.dataset.block;
                });
            });

            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WASD
            document.addEventListener('keydown', (e) => {
                if (!gameRunning) return;
                
                switch(e.key.toLowerCase()) {
                    case 'w':
                    case '—Ü': // –†—É—Å—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞
                        e.preventDefault();
                        movePlayer(0, -1);
                        break;
                    case 's':
                    case '—ã':
                        e.preventDefault();
                        movePlayer(0, 1);
                        break;
                    case 'a':
                    case '—Ñ':
                        e.preventDefault();
                        movePlayer(-1, 0);
                        break;
                    case 'd':
                    case '–≤':
                        e.preventDefault();
                        movePlayer(1, 0);
                        break;
                }
            });

            // Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞
            document.getElementById('mathAnswer').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeMathModal();
                }
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', () => {
                positionPlayer();
                positionMonster();
            });
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        initGame();
    </script>
</body>
</html>